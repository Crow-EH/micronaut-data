Micronaut Data supports multi-tenancy to allow the use of multiple databases or schemas by a single micronaut application.

.Supported Multitenancy Modes
[cols=2*]
|===
|*Mode*
|*Description*

|DATASOURCE
|Use different repositories and datasources. Transaction Manager is used based on the tenant defined.

|SCHEMA
|Only supported by JDBC/R2DBC/MongoDB (collections)

|===

=== Datasource Mode
The DATASOURCE mode is used in combination with the micronaut-multitenancy library in order to resolve the tenant name.
In the below example, the tenant resolver is set to use an http header. See https://micronaut-projects.github.io/micronaut-multitenancy/latest/guide/[Micronaut Multitenancy] for more information.

[source,yaml]
----
micronaut:
  data:
    multi-tenancy:
      mode: DATASOURCE
  multitenancy:
    tenantresolver:
      httpheader:
        enabled: true

datasources:
  tenantA:
    url: jdbc:h2:mem:dbTenantA
    driverClassName: org.h2.Driver
    username: sa
    password: ''
    schema-generate: CREATE_DROP
    dialect: H2
  tenantB:
    url: jdbc:h2:mem:dbTenantB
    driverClassName: org.h2.Driver
    username: sa
    password: ''
    schema-generate: CREATE_DROP
    dialect: H2
----

=== Schema Mode
The SCHEMA mode uses a single datasource and set the active schema based on the tenant resolved.

[source,yaml]
----
micronaut:
  data:
    multi-tenancy:
      mode: SCHEMA
  multitenancy:
    tenantresolver:
      httpheader:
        enabled: true

datasources:
  default:
    url: jdbc:h2:mem:db
    driverClassName: org.h2.Driver
    username: sa
    password: ''
    dialect: H2
----
